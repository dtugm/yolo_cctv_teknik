
<!DOCTYPE html>
<html>
<head>
    <title>YOLO Live Stream</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .video-container {
            text-align: center;
            margin: 20px 0;
        }
        .video-stream {
            max-width: 100%;
            height: auto;
            border: 2px solid #333;
            border-radius: 5px;
        }
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        .btn {
            padding: 10px 20px;
            margin: 5px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
        }
        .btn:hover {
            background-color: #0056b3;
        }
        .btn-danger {
            background-color: #dc3545;
        }
        .btn-danger:hover {
            background-color: #c82333;
        }
        .info {
            background-color: #e9ecef;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöó YOLO Live Vehicle Detection Stream</h1>
        
        <div class="video-container">
            <img src="{{ url_for('video_feed') }}" class="video-stream" alt="Live Stream">
        </div>
        
        <div class="controls">
            <a href="/start/cam" class="btn">üìπ Start Webcam</a>
            <button onclick="startRTSP()" class="btn">üì° Start RTSP Stream</button>
            <a href="/stop" class="btn btn-danger">‚èπÔ∏è Stop Stream</a>
        </div>

        <script>
        function startRTSP() {
            const rtspUrl = "rtsp://10.2.10.70:7447/owNskP1rv1LKe2mV";
            console.log('Starting RTSP stream with URL:', rtspUrl);
            
            // Use fetch to start the stream
            fetch('/start/' + encodeURIComponent(rtspUrl))
                .then(response => response.text())
                .then(data => {
                    console.log('Response:', data);
                    // Wait a moment for the stream to initialize, then reload
                    setTimeout(() => {
                        location.reload();
                    }, 2000);
                })
                .catch(error => {
                    console.error('Error starting RTSP stream:', error);
                    alert('Error starting RTSP stream: ' + error);
                });
        }
        </script>

        <div class="info">
            <h3>üìã Instructions:</h3>
            <ul>
                <li><strong>Webcam:</strong> Click "Start Webcam" to use your default camera</li>
                <li><strong>RTSP Stream:</strong> Modify the RTSP URL in the button above or use the custom URL format</li>
                <li><strong>Custom Source:</strong> Use /start/YOUR_SOURCE_HERE in the URL</li>
                <li><strong>Stop:</strong> Click "Stop Stream" to end the current stream</li>
            </ul>
            
            <h3>üéØ Features:</h3>
            <ul>
                <li>Real-time vehicle detection and tracking</li>
                <li>Speed estimation</li>
                <li>Vehicle counting (entering/leaving)</li>
                <li>Live FPS and system statistics</li>
                <li>Support for webcam and RTSP streams</li>
            </ul>
            
            <h3>üîß Custom RTSP URL Format:</h3>
            <p>Replace underscores with appropriate characters:</p>
            <code>/start/rtsp_YOUR_IP_PORT_PATH</code>
            <p>Example: <code>/start/rtsp_192.168.1.100_554_stream1</code></p>
        </div>
    </div>
    
    <script>
        // Auto-refresh the page if the image fails to load
        document.querySelector('.video-stream').onerror = function() {
            setTimeout(function() {
                location.reload();
            }, 5000);
        };
    </script>
</body>
</html>
    